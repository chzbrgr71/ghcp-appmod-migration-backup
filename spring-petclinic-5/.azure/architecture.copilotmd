# Spring PetClinic - Azure Architecture Diagram

> **Note:** To view this diagram, please install a Mermaid preview extension in VS Code (such as "Markdown Preview Mermaid Support" or "Mermaid Markdown Syntax Highlighting").

## Architecture Overview

This diagram shows the Azure architecture for the Spring PetClinic application deployed on Azure Kubernetes Service (AKS).

```mermaid
graph TD
%% Services
svcazurekubernetesservice_petclinic["`Name: petclinic
Path: src/main/java/org/springframework/samples/petclinic
Language: java
Port: 8080`"]
subgraph "Compute Resources"
%% Resources
subgraph akscluster["Azure Kubernetes Service (AKS) Cluster"]
azurekubernetesservice_petclinic("`petclinic (Containerized Service)`")
end
akscluster:::cluster
end
subgraph "Dependency Resources"
%% Dependency Resources
azuredatabaseforpostgresql_dbpetclinic14db["`db-petclinic14db (Azure Database for PostgreSQL)`"]
azurecontainerregistry_acrpetclinic14dbb6["`acrpetclinic14dbb6 (Azure Container Registry)`"]
end
%% Relationships
svcazurekubernetesservice_petclinic --> |"hosted on"| azurekubernetesservice_petclinic
azurekubernetesservice_petclinic -.-> |"user-identity"| azuredatabaseforpostgresql_dbpetclinic14db
azurekubernetesservice_petclinic -.-> |"system-identity"| azurecontainerregistry_acrpetclinic14dbb6
```

## Data Flow

1. **Application Hosting**: The Spring PetClinic Java application is containerized and runs as a deployment in the Azure Kubernetes Service (AKS) cluster named `briar-aks`.

2. **Database Connection**: The application connects to Azure Database for PostgreSQL (`db-petclinic14db`) using User-Assigned Managed Identity for passwordless authentication. The database contains the petclinic schema and data.

3. **Container Registry**: The AKS cluster pulls the container image from Azure Container Registry (`acrpetclinic14dbb6`) using System-Assigned Managed Identity for authentication.

4. **Security**: All connections utilize Azure Managed Identity for secure, passwordless authentication, eliminating the need to store credentials in code or configuration.

## Components

- **Compute**: Azure Kubernetes Service (AKS) - Container orchestration platform
- **Database**: Azure Database for PostgreSQL Flexible Server (version 15) - Relational database for application data
- **Registry**: Azure Container Registry - Stores and manages container images
- **Identity**: Managed Identity - Provides secure authentication without credentials
